import{_ as i,c as a,o as t,ae as e}from"./chunks/framework.CflXwq_F.js";const n="/documents/assets/img.Defyr9ON.png",g=JSON.parse('{"title":"Introduction","description":"","frontmatter":{},"headers":[],"relativePath":"introduction.md","filePath":"introduction.md"}'),h={name:"introduction.md"};function l(p,s,k,r,d,o){return t(),a("div",null,s[0]||(s[0]=[e('<h1 id="introduction" tabindex="-1">Introduction <a class="header-anchor" href="#introduction" aria-label="Permalink to &quot;Introduction&quot;">​</a></h1><p>Welcome to the BunnyFinder documents. This guide will help you get started with installing, configuring, and using the BunnyFinder framework.</p><p><img src="'+n+`" alt="Logo"></p><h1 id="installation" tabindex="-1">Installation <a class="header-anchor" href="#installation" aria-label="Permalink to &quot;Installation&quot;">​</a></h1><h2 id="requirements" tabindex="-1">Requirements <a class="header-anchor" href="#requirements" aria-label="Permalink to &quot;Requirements&quot;">​</a></h2><h4 id="software-requirements" tabindex="-1">Software Requirements <a class="header-anchor" href="#software-requirements" aria-label="Permalink to &quot;Software Requirements&quot;">​</a></h4><ul><li>Ubuntu 22.04 and later</li><li>Docker 24.0.6 and later</li><li>docker-compose plugin</li><li>kurtosis client</li></ul><h4 id="hardware-requirements" tabindex="-1">Hardware Requirements <a class="header-anchor" href="#hardware-requirements" aria-label="Permalink to &quot;Hardware Requirements&quot;">​</a></h4><ul><li>At least 8-cores CPU and 8GB of memory</li></ul><h2 id="installation-steps" tabindex="-1">Installation Steps <a class="header-anchor" href="#installation-steps" aria-label="Permalink to &quot;Installation Steps&quot;">​</a></h2><ul><li>Clone the repository: <code>git clone https://github.com/tsinghua-cel/bunnyfinder</code></li><li>Enter the directory: <code>cd bunnyfinder</code></li><li>Build the docker images: <code>make docker</code></li></ul><h1 id="configuration" tabindex="-1">Configuration <a class="header-anchor" href="#configuration" aria-label="Permalink to &quot;Configuration&quot;">​</a></h1><h2 id="settings" tabindex="-1">Settings <a class="header-anchor" href="#settings" aria-label="Permalink to &quot;Settings&quot;">​</a></h2><ul><li><code>image</code> : The docker image to use for <code>bunnyfinder</code> service.</li><li><code>dbconnect</code>: The database connection string, current only support mysql database, e.g. <code>root:password@tcp(ip:port)/dbname</code></li><li><code>min_malicious_idx</code>: The min index that actor as a malicious validator.</li><li><code>max_malicious_idx</code>: The max index that actor as a malicious validator.</li><li><code>duration_per_strategy</code>: The execute duration for each strategy in minutes, this is used when <code>strategy</code> is set to <code>all</code> or multiple strategies.</li><li><code>strategy</code>: The strategy to use, support <code>all</code>, <code>random</code>, <code>exante</code>, <code>ext_exante</code>, <code>sandwich</code>, <code>ext_sandwich</code>, <code>staircase</code>, <code>ext_staircase</code>, <code>unrealized</code>, <code>ext_unrealized</code>, <code>withholding</code>, <code>ext_withholding</code>.</li></ul><h4 id="strategy-description" tabindex="-1">Strategy Description <a class="header-anchor" href="#strategy-description" aria-label="Permalink to &quot;Strategy Description&quot;">​</a></h4><ul><li>all: Execute all existing strategies, switch to a different existing strategy randomly every <code>duration_per_strategy</code> minutes.</li><li>random: Randomly generate an attack strategy.</li><li>exante: Execute ex-ante attack.</li><li>ext_exante: Execute ex-ante attack with some additional random attack strategies.</li><li>sandwich: Execute sandwich attack.</li><li>ext_sandwich: Execute sandwich attack with some additional random attack strategies.</li><li>staircase: Execute staircase attack.</li><li>ext_staircase: Execute staircase attack with some additional random attack strategies.</li><li>unrealized: Execute unrealized attack.</li><li>ext_unrealized: Execute unrealized attack with some additional random attack strategies.</li><li>withholding: Execute withholding attack.</li><li>ext_withholding: Execute withholding attack with some additional random attack strategies.</li></ul><h2 id="example" tabindex="-1">Example <a class="header-anchor" href="#example" aria-label="Permalink to &quot;Example&quot;">​</a></h2><p>Bellow is an example of the configuration file, it use the <code>bunnyfinder:latest</code> docker image, connect to a local mysql database, and execute the <code>random</code> and <code>exante</code> strategies with a duration of 30 minutes for each strategy.</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  image</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;bunnyfinder:latest&#39;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  strategy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;random,exante&#39;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  dbconnect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;eth:12345678@tcp(127.0.0.1:3306)/eth&#39;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  max_malicious_idx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;85&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  duration_per_strategy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;30&quot;</span></span></code></pre></div><h1 id="usage" tabindex="-1">Usage <a class="header-anchor" href="#usage" aria-label="Permalink to &quot;Usage&quot;">​</a></h1><h2 id="basic-usage" tabindex="-1">Basic Usage <a class="header-anchor" href="#basic-usage" aria-label="Permalink to &quot;Basic Usage&quot;">​</a></h2><p>We have integrated <code>Bunnyfinder</code> into the <code>ethereum-package</code>. You can run tests on an Ethereum PoS network with multiple client versions. Below is an example of running tests and retrieving the results.</p><h4 id="start-the-test" tabindex="-1">Start the Test <a class="header-anchor" href="#start-the-test" aria-label="Permalink to &quot;Start the Test&quot;">​</a></h4><p>We provide some scripts and test parameter files in the <code>guide</code> directory.</p><p>First, you need to switch to the <code>guide</code> directory.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> guide</span></span></code></pre></div><p>Then, use the following command to start the test.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./run.sh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> testname</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./testset/network_params.yaml</span></span></code></pre></div><p>Here, we are running three sets of beacon nodes, each using a different client. The execution layer includes <code>besu</code>, <code>geth</code>, and <code>nethermind</code>, while the consensus layer includes <code>prysm</code>, <code>lighthouse</code>, and <code>teku</code>.</p><p>When the following log appears, it indicates that the entire test has run successfully.</p><div class="language-text vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>========================================== User Services ==========================================</span></span>
<span class="line"><span>UUID           Name                                             Ports                                         Status</span></span>
<span class="line"><span>90ee4bff7ac7   bunnyfinder                                      http: 19000/tcp -&gt; http://127.0.0.1:32828     RUNNING</span></span>
<span class="line"><span>0a95359926df   cl-1-prysm-besu                                  http: 3500/tcp -&gt; http://127.0.0.1:32819      RUNNING</span></span>
<span class="line"><span>                                                                metrics: 8080/tcp -&gt; http://127.0.0.1:32816   </span></span>
<span class="line"><span>                                                                profiling: 6060/tcp -&gt; 127.0.0.1:32817        </span></span>
<span class="line"><span>                                                                rpc: 4000/tcp -&gt; 127.0.0.1:32818              </span></span>
<span class="line"><span>                                                                tcp-discovery: 13000/tcp -&gt; 127.0.0.1:32815   </span></span>
<span class="line"><span>                                                                udp-discovery: 12000/udp -&gt; 127.0.0.1:32777   </span></span>
<span class="line"><span>895d9bf907f9   cl-2-lighthouse-geth                             http: 4000/tcp -&gt; http://127.0.0.1:32822      RUNNING</span></span>
<span class="line"><span>                                                                metrics: 5054/tcp -&gt; http://127.0.0.1:32821   </span></span>
<span class="line"><span>                                                                tcp-discovery: 9000/tcp -&gt; 127.0.0.1:32820    </span></span>
<span class="line"><span>                                                                udp-discovery: 9000/udp -&gt; 127.0.0.1:32778    </span></span>
<span class="line"><span>5c8e2e2c7c7d   cl-3-teku-nethermind                             http: 4000/tcp -&gt; http://127.0.0.1:32825      RUNNING</span></span>
<span class="line"><span>                                                                metrics: 8008/tcp -&gt; http://127.0.0.1:32824   </span></span>
<span class="line"><span>                                                                tcp-discovery: 9000/tcp -&gt; 127.0.0.1:32823    </span></span>
<span class="line"><span>                                                                udp-discovery: 9000/udp -&gt; 127.0.0.1:32779    </span></span>
<span class="line"><span>af977800bf29   el-1-besu-prysm                                  engine-rpc: 8551/tcp -&gt; 127.0.0.1:32802       RUNNING</span></span>
<span class="line"><span>                                                                metrics: 9001/tcp -&gt; http://127.0.0.1:32801   </span></span>
<span class="line"><span>                                                                rpc: 8545/tcp -&gt; 127.0.0.1:32804              </span></span>
<span class="line"><span>                                                                tcp-discovery: 30303/tcp -&gt; 127.0.0.1:32800   </span></span>
<span class="line"><span>                                                                udp-discovery: 30303/udp -&gt; 127.0.0.1:32774   </span></span>
<span class="line"><span>                                                                ws: 8546/tcp -&gt; 127.0.0.1:32803               </span></span>
<span class="line"><span>b861d349ff1a   el-2-geth-lighthouse                             engine-rpc: 8551/tcp -&gt; 127.0.0.1:32807       RUNNING</span></span>
<span class="line"><span>                                                                metrics: 9001/tcp -&gt; http://127.0.0.1:32806   </span></span>
<span class="line"><span>                                                                rpc: 8545/tcp -&gt; 127.0.0.1:32809              </span></span>
<span class="line"><span>                                                                tcp-discovery: 30303/tcp -&gt; 127.0.0.1:32805   </span></span>
<span class="line"><span>                                                                udp-discovery: 30303/udp -&gt; 127.0.0.1:32775   </span></span>
<span class="line"><span>                                                                ws: 8546/tcp -&gt; 127.0.0.1:32808               </span></span>
<span class="line"><span>8900b3150379   el-3-nethermind-teku                             engine-rpc: 8551/tcp -&gt; 127.0.0.1:32812       RUNNING</span></span>
<span class="line"><span>                                                                metrics: 9001/tcp -&gt; http://127.0.0.1:32811   </span></span>
<span class="line"><span>                                                                rpc: 8545/tcp -&gt; 127.0.0.1:32814              </span></span>
<span class="line"><span>                                                                tcp-discovery: 30303/tcp -&gt; 127.0.0.1:32810   </span></span>
<span class="line"><span>                                                                udp-discovery: 30303/udp -&gt; 127.0.0.1:32776   </span></span>
<span class="line"><span>                                                                ws: 8546/tcp -&gt; 127.0.0.1:32813               </span></span>
<span class="line"><span>5578c58fd8d8   validator-key-generation-cl-validator-keystore   &lt;none&gt;                                        RUNNING</span></span>
<span class="line"><span>ff8b93b77564   vc-1-besu-prysm                                  metrics: 8080/tcp -&gt; http://127.0.0.1:32826   RUNNING</span></span>
<span class="line"><span>305d686276e2   vc-2-geth-lighthouse                             metrics: 8080/tcp -&gt; http://127.0.0.1:32827   RUNNING</span></span></code></pre></div><h4 id="retrieve-the-results" tabindex="-1">Retrieve the Results <a class="header-anchor" href="#retrieve-the-results" aria-label="Permalink to &quot;Retrieve the Results&quot;">​</a></h4><p>After running the test for at least 3 epochs (about 20 minutes), we can log in to the database to check the results.</p><p>Use SQL query to check whether any vulnerabilities have been detected and identify the corresponding strategies.</p><p>(1) Log in to the database, enter the password, and then switch to the eth database. When prompted for a password, enter “12345678”.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> exec</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -it</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ethmysql</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mysql</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> root</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Enter</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> password:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Welcome</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MySQL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> monitor.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Commands</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> end</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> with</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">or</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\g</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Your</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MySQL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> connection</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> id</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> is</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 9</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> version:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 9.1.0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MySQL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Community</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> GPL</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">use</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> eth</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Database</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> changed</span></span></code></pre></div><p>(2) Use the following SQL queries to check for specific vulnerabilities:</p><h5 id="sql1-this-query-checks-for-reorganization-events" tabindex="-1">SQL1: This query checks for reorganization events <a class="header-anchor" href="#sql1-this-query-checks-for-reorganization-events" aria-label="Permalink to &quot;SQL1: This query checks for reorganization events&quot;">​</a></h5><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> content, reorg_count </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> t_strategy </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> reorg_count </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>If the result is non-empty, it indicates that the current attack has triggered a reorganization, and the \\texttt{content} field should be recorded as an effective attack strategy.</p><h5 id="sql2-this-query-checks-for-increased-honest-validator-s-reward-loss" tabindex="-1">SQL2: This query checks for increased &quot;honest validator&#39;s reward loss&quot; <a class="header-anchor" href="#sql2-this-query-checks-for-increased-honest-validator-s-reward-loss" aria-label="Permalink to &quot;SQL2: This query checks for increased &quot;honest validator&#39;s reward loss&quot;&quot;">​</a></h5><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> content, honest_lose_rate_avg </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> t_strategy </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> honest_lose_rate_avg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>If the result is non-empty, it indicates that the current attack has caused an increase in the honest reward loss rate. Again, the <code>content</code> field should be recorded as an effective attack strategy.</p><h5 id="sql3-this-query-compares-the-honest-and-attacker-loss-rates" tabindex="-1">SQL3: This query compares the honest and attacker loss rates <a class="header-anchor" href="#sql3-this-query-compares-the-honest-and-attacker-loss-rates" aria-label="Permalink to &quot;SQL3: This query compares the honest and attacker loss rates&quot;">​</a></h5><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> content, honest_lose_rate_avg, attacker_lose_rate_avg </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> t_strategy </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> honest_lose_rate_avg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> attacker_lose_rate_avg;</span></span></code></pre></div><p>If the result is non-empty, it suggests that the honest reward loss rate is higher than the attacker&#39;s loss rate, and the \\texttt{content} field should be recorded as an effective attack strategy.</p><p>If <em>SQL1</em>, <em>SQL2</em>, and <em>SQL3</em> all return empty results, it means that none of the strategies in the current attack are effective. Otherwise, it indicates that the attack is successful with some effective strategies.</p><h4 id="stop-the-test" tabindex="-1">Stop the Test <a class="header-anchor" href="#stop-the-test" aria-label="Permalink to &quot;Stop the Test&quot;">​</a></h4><p>To stop the test, run the following command:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./stop.sh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> testname</span></span></code></pre></div><p>Due to the limitations of Kurtosis, the test cannot be restarted once it has stopped.</p><h2 id="advance-usage" tabindex="-1">Advance Usage <a class="header-anchor" href="#advance-usage" aria-label="Permalink to &quot;Advance Usage&quot;">​</a></h2><p>This section will introduce how to add new attack strategy in <code>Bunnyfinder</code> and define the test network.</p><h3 id="create-custom-strategies" tabindex="-1">Create Custom Strategies <a class="header-anchor" href="#create-custom-strategies" aria-label="Permalink to &quot;Create Custom Strategies&quot;">​</a></h3><p>To define a custom attack strategy, follow these steps:</p><h5 id="change-the-directory" tabindex="-1">Change the Directory <a class="header-anchor" href="#change-the-directory" aria-label="Permalink to &quot;Change the Directory&quot;">​</a></h5><p>Move to the <code>bunnyfinder/library</code> directory:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bunnyfinder/library</span></span></code></pre></div><h5 id="create-a-new-strategy" tabindex="-1">Create a New Strategy <a class="header-anchor" href="#create-a-new-strategy" aria-label="Permalink to &quot;Create a New Strategy&quot;">​</a></h5><p>Use an existing strategy as a template. For example, duplicate the <code>withholding</code> strategy and rename it:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> library/withholding</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> library/mystrategy</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mv</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> library/mystrategy/withholding.go</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> library/mystrategy/mystrategy.go</span></span></code></pre></div><h5 id="modify-the-strategy" tabindex="-1">Modify the Strategy <a class="header-anchor" href="#modify-the-strategy" aria-label="Permalink to &quot;Modify the Strategy&quot;">​</a></h5><p>Make the following updates in the <code>library/mystrategy</code> directory:</p><ul><li>Update package declarations: change the first line in <code>mystrategy.go</code>, <code>check.go</code>, and <code>block.go</code> files from &quot;package withholding&quot; to &quot;package mystrategy&quot;.</li><li>Modify the Name method: alter the Name method return value to &quot;mystrategy&quot; in <code>mystrategy.go</code>.</li><li>Adjust the Description method: update the Description method to reflect the characteristics of the new strategy.</li><li>Register new strategy: open the <code>library/library.go</code> file, find the <code>Init</code> function, and add code <code>register(&amp;mystrategy.Instance{})</code>.</li></ul><h5 id="define-trigger-conditions" tabindex="-1">Define Trigger Conditions <a class="header-anchor" href="#define-trigger-conditions" aria-label="Permalink to &quot;Define Trigger Conditions&quot;">​</a></h5><p>The file <code>check.go</code> in <code>library/mystrategy</code> directory is used to define the trigger conditions for the strategy.</p><p>It defines a <code>CheckDuties</code> method, which is used to proactively determine whether to issue attack strategies based on the propose duties for each slot in the next epoch.</p><p>Then, customize the <code>CheckDuties</code> function to define the trigger conditions. An example is shown as follows.</p><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> CheckDuties</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">param</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> types</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">LibraryParams</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">duties</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> []</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">types</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ProposerDuty</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) ([]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{}, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">bool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> make</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    tmpsub </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> make</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([]</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">types</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ProposerDuty</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _, duty </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> duties {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        valIdx, _ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> strconv.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Atoi</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(duty.ValidatorIndex)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> types.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">IsHackValidator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(valIdx, param) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            tmpsub </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> append</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(tmpsub, duty)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            if</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(tmpsub) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> append</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(result, tmpsub)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            tmpsub </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> make</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([]</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">types</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ProposerDuty</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(tmpsub) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> append</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(result, tmpsub)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(result) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h5 id="define-attack-actions" tabindex="-1">Define Attack Actions <a class="header-anchor" href="#define-attack-actions" aria-label="Permalink to &quot;Define Attack Actions&quot;">​</a></h5><p>The file <code>block.go</code> in <code>library/mystrategy</code> directory is used to define detail strategies.</p><p>Fill the <code>GenSlotStrategy</code> method using the customized strategies. Below is an updated example:</p><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> GenSlotStrategy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">allHacks</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> []</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{}) []</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">types</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SlotStrategy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    slotsPerEpoch </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> globalinfo.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ChainBaseInfo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().SlotsPerEpoch</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    secondsPerSlot </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> globalinfo.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ChainBaseInfo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().SecondsPerSlot</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    strategys </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> make</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([]</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">types</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SlotStrategy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _, hack </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> allHacks {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        subduties </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> hack.([]</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">types</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ProposerDuty</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        endSlot, _ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> strconv.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Atoi</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(subduties[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(subduties)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].Slot)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(subduties); i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            slot, _ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> strconv.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Atoi</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(subduties[i].Slot)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            strategy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> types</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SlotStrategy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                Slot:    subduties[i].Slot,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                Level:   </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                Actions: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            delaySlots </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> endSlot </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> slot </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> slotsPerEpoch</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            strategy.Actions[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;BlockBeforeBroadCast&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> fmt.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Sprintf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;delayWithDuration:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, delaySlots</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">secondsPerSlot)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            strategy.Actions[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;AttestBeforeBroadCast&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> fmt.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Sprintf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;delayWithDuration:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, delaySlots</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">secondsPerSlot)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            strategys </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> append</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(strategys, strategy)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> strategys</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h5 id="compile-and-test" tabindex="-1">Compile and Test <a class="header-anchor" href="#compile-and-test" aria-label="Permalink to &quot;Compile and Test&quot;">​</a></h5><p>Build the code and generate updated docker images:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker</span></span></code></pre></div><p>And then, you can refer to the <code>Basic Usage</code> section to run the test network with the new strategy.</p><h3 id="custom-test-network" tabindex="-1">Custom Test Network <a class="header-anchor" href="#custom-test-network" aria-label="Permalink to &quot;Custom Test Network&quot;">​</a></h3><p>To be continue.</p>`,79)]))}const E=i(h,[["render",l]]);export{g as __pageData,E as default};
