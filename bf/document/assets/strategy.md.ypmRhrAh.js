import{_ as s,c as i,o as a,ae as e}from"./chunks/framework.CLBIubxr.js";const k=JSON.parse('{"title":"Strategy Category","description":"","frontmatter":{},"headers":[],"relativePath":"strategy.md","filePath":"strategy.md"}'),n={name:"strategy.md"};function o(l,t,d,h,r,p){return a(),i("div",null,t[0]||(t[0]=[e(`<h1 id="strategy-category" tabindex="-1">Strategy Category <a class="header-anchor" href="#strategy-category" aria-label="Permalink to &quot;Strategy Category&quot;">​</a></h1><p>In this section, we will describe how we formally define attack behavior. We define a strategy specification format (SSF) in the form of JSON, specifying the exact time each message should be delayed and what content the message should be modified for the Byzantine validators. SSF file is defined as some JSON templates for both order manipulation and content manipulation. Based on the concrete attack strategies (e.g., the number of units each message should be delayed), the corresponding template is &quot;filled&quot;. To be specific, in each slot, our SSF defines three factors: <code>slot</code> denotes the slot Byzantine validators should take the actions; <code>actions</code> denotes the actual attack strategies. One SSF file contains all slots&#39; attack strategies in three epoch. The strategy format is shown in JSON. An example of JSON is as follows:</p><div class="language-JSON vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">JSON</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[   </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;slot&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;actions&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            &quot;point1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;action1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            &quot;point2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;action2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">            ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;slot&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;actions&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            &quot;point1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;action1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            &quot;point2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;action2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">            ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        },</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">        ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre></div><h2 id="inject-points-and-possible-actions" tabindex="-1">Inject Points and Possible Actions <a class="header-anchor" href="#inject-points-and-possible-actions" aria-label="Permalink to &quot;Inject Points and Possible Actions&quot;">​</a></h2><p>BunnyFinder manipulates validator behavior by injecting faults at various points in the Ethereum PoS protocol. Below are the key inject points and their possible actions:</p><table tabindex="0"><thead><tr><th>Inject Point</th><th>Description</th><th>Possible Actions</th></tr></thead><tbody><tr><td><code>BlockBeforeBroadCast</code></td><td>When Byzantine validators attempt to broadcast a block.</td><td><code>return</code>, <code>delayWithDuration:x</code></td></tr><tr><td><code>BlockGetNewParentRoot</code></td><td>When Byzantine validators fetch the parent block.</td><td><code>modifyParentRoot:x</code></td></tr><tr><td><code>BlockBeforeSign</code></td><td>Before Byzantine validators pack attestations.</td><td><code>packPooledAttest</code></td></tr><tr><td><code>AttestBeforeBroadCast</code></td><td>When Byzantine validators attempt to broadcast attestations.</td><td><code>return</code>, <code>delayWithDuration:x</code></td></tr><tr><td><code>AttestBeforeSign</code></td><td>Before Byzantine validators create an attestation.</td><td><code>modifyAttestHead:x</code>, <code>modifyAttestSource:x</code>, <code>modifyAttestTarget:x</code></td></tr></tbody></table><h2 id="possible-actions" tabindex="-1">Possible Actions <a class="header-anchor" href="#possible-actions" aria-label="Permalink to &quot;Possible Actions&quot;">​</a></h2><table tabindex="0"><thead><tr><th>Action</th><th>Description</th></tr></thead><tbody><tr><td><code>return</code></td><td>Prevents the validator from broadcasting a block or attestation.</td></tr><tr><td><code>delayWithDuration:x</code></td><td>Delays the action by <code>x</code> time units (each unit = 4 seconds).</td></tr><tr><td><code>modifyParentRoot:x</code></td><td>Replaces the parent block with the block from slot <code>x</code>.</td></tr><tr><td><code>packPooledAttest</code></td><td>Packs attestations from Byzantine validators.</td></tr><tr><td><code>modifyAttestHead:x</code></td><td>Replaces the head field with the block from slot <code>x</code>.</td></tr><tr><td><code>modifyAttestSource:x</code></td><td>Replaces the source field with the block from slot <code>x</code>.</td></tr><tr><td><code>modifyAttestTarget:x</code></td><td>Replaces the target field with the block from slot <code>x</code>.</td></tr></tbody></table><h2 id="strategy-implementation-example" tabindex="-1">Strategy Implementation Example <a class="header-anchor" href="#strategy-implementation-example" aria-label="Permalink to &quot;Strategy Implementation Example&quot;">​</a></h2><p>An example SSF entry for a Byzantine validator delaying block broadcasts and modifying attestations:</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;slot&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;10&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;actions&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            &quot;BlockBeforeBroadCast&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;delayWithDuration:2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            &quot;BlockGetNewParentRoot&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;modifyParentRoot:8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            &quot;AttestBeforeSign&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;modifyAttestHead:9&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre></div><p>This strategy:</p><ul><li>Delays block broadcast by two time units.</li><li>Modifies the parent root of a block.</li><li>Alters the head field in attestations.</li></ul><h2 id="conclusion" tabindex="-1">Conclusion <a class="header-anchor" href="#conclusion" aria-label="Permalink to &quot;Conclusion&quot;">​</a></h2><p>BunnyFinder systematically explores Ethereum PoS incentive vulnerabilities by iteratively refining attack strategies based on execution results. By leveraging SSF-defined strategies, it enables the automated discovery of flaws that could be exploited in real-world blockchain environments.</p>`,15)]))}const E=s(n,[["render",o]]);export{k as __pageData,E as default};
